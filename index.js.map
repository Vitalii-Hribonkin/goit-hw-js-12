{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '47432797-7b7ae49ed8d9ca3634e43854b';\nconst BASE_URL = 'https://pixabay.com/api/';\n\nlet currentPage = 1;\n\n/**\n * Запрашивает изображения по ключевому слову с учетом пагинации.\n * @param {string} query - поисковый запрос.\n * @returns {Promise<{ hits: Array, totalHits: number }>} - Данные от API.\n */\nexport const fetchImages = async (query, page = 1) => {\n  const params = new URLSearchParams({\n    key: API_KEY,\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page: 15,\n    page,\n  });\n\n  try {\n    const response = await axios.get(`${BASE_URL}?${params}`);\n    return response.data;\n  } catch (error) {\n    throw new Error('Failed to fetch images');\n  }\n};\n","import SimpleLightbox from 'simplelightbox';\n\nlet lightbox;\n\n/**\n * Очищает галерею или добавляет новые изображения.\n * @param {HTMLElement} galleryElement - элемент галереи.\n * @param {Array} images - список изображений для рендеринга.\n * @param {boolean} append - добавлять ли новые изображения.\n */\nexport const renderGallery = (galleryElement, images, append = false) => {\n  const markup = images\n    .map(\n      (img) => `\n      <li class=\"li\">\n        <a href=\"${img.largeImageURL}\">\n          <img src=\"${img.webformatURL}\" alt=\"${img.tags}\" />\n        </a>\n        <div class=\"div\">\n          <p class=\"p\">Likes: ${img.likes}</p>\n          <p class=\"p\">Views: ${img.views}</p>\n          <p class=\"p\">Comments: ${img.comments}</p>\n          <p class=\"p\">Downloads: ${img.downloads}</p>\n        </div>\n      </li>\n    `\n    )\n    .join('');\n\n  if (append) {\n    galleryElement.insertAdjacentHTML('beforeend', markup);\n  } else {\n    galleryElement.innerHTML = markup;\n  }\n\n  if (!lightbox) {\n    lightbox = new SimpleLightbox('.gallery a');\n  } else {\n    lightbox.refresh();\n  }\n};\n","import 'izitoast/dist/css/iziToast.min.css';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport iziToast from 'izitoast';\nimport { fetchImages } from './js/pixabay-api.js';\nimport { renderGallery } from './js/render-functions.js';\n\nconst searchForm = document.getElementById('search-form');\nconst gallery = document.getElementById('gallery');\nconst loader = document.getElementById('loader');\nconst loadMoreButton = document.getElementById('load-more');\n\nlet page = 1; // Текущая страница\nlet query = ''; // Последний поисковый запрос\nlet totalHits = 0; // Общее количество изображений\n\nconst showLoader = () => loader.classList.remove('hidden');\nconst hideLoader = () => loader.classList.add('hidden');\nconst showLoadMoreButton = () => loadMoreButton.classList.remove('hidden');\nconst hideLoadMoreButton = () => loadMoreButton.classList.add('hidden');\n\nconst scrollPage = () => {\n  const { height: cardHeight } = gallery.firstElementChild.getBoundingClientRect();\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n};\n\nconst handleSearch = async (event) => {\n  event.preventDefault();\n  query = searchForm.elements['search-input'].value.trim();\n  page = 1;\n\n  if (!query) {\n    iziToast.error({ title: 'Error', message: 'Please enter a search query!' });\n    return;\n  }\n\n  gallery.innerHTML = '';\n  hideLoadMoreButton();\n  showLoader();\n\n  try {\n    const { images, total } = await fetchImages(query, page);\n    totalHits = total;\n\n    if (images.length === 0) {\n      iziToast.warning({\n        title: 'No Results',\n        message: 'Sorry, there are no images matching your search query. Please try again!',\n      });\n    } else {\n      renderGallery(gallery, images);\n      if (images.length < totalHits) showLoadMoreButton();\n    }\n  } catch (error) {\n    iziToast.error({ title: 'Error', message: 'Something went wrong. Please try again later!' });\n  } finally {\n    hideLoader();\n  }\n};\n\nconst handleLoadMore = async () => {\n  page += 1;\n  hideLoadMoreButton();\n  showLoader();\n\n  try {\n    const { images } = await fetchImages(query, page);\n\n    if (images.length === 0) {\n      iziToast.info({ message: \"We're sorry, but you've reached the end of search results.\" });\n      hideLoadMoreButton();\n      return;\n    }\n\n    renderGallery(gallery, images, true); // Добавляем новые изображения\n    if (page * 15 >= totalHits) {\n      hideLoadMoreButton();\n      iziToast.info({ message: \"We're sorry, but you've reached the end of search results.\" });\n    } else {\n      showLoadMoreButton();\n    }\n\n    scrollPage();\n  } catch (error) {\n    iziToast.error({ title: 'Error', message: 'Failed to load more images!' });\n  } finally {\n    hideLoader();\n  }\n};\n\nsearchForm.addEventListener('submit', handleSearch);\nloadMoreButton.addEventListener('click', handleLoadMore);\n"],"names":["API_KEY","BASE_URL","fetchImages","query","page","params","axios","lightbox","renderGallery","galleryElement","images","append","markup","img","SimpleLightbox","searchForm","gallery","loader","loadMoreButton","totalHits","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","scrollPage","cardHeight","handleSearch","event","iziToast","total","handleLoadMore"],"mappings":"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"}