{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '47432797-7b7ae49ed8d9ca3634e43854b';\nconst BASE_URL = 'https://pixabay.com/api/';\n\nlet currentPage = 1;\n\n/**\n * Запрашивает изображения по ключевому слову с учетом пагинации.\n * @param {string} query - поисковый запрос.\n * @returns {Promise<{ hits: Array, totalHits: number }>} - Данные от API.\n */\nexport const fetchImages = async (query, page = 1) => {\n  const params = new URLSearchParams({\n    key: API_KEY,\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page: 15,\n    page,\n  });\n\n  try {\n    const response = await axios.get(`${BASE_URL}?${params}`);\n    return response.data;\n  } catch (error) {\n    throw new Error('Failed to fetch images');\n  }\n};\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nlet lightbox;\n\n/**\n * Створює розмітку для галереї.\n * @param {Array} images - список об'єктів із зображеннями.\n * @returns {string} - HTML-розмітка.\n */\nexport const createGalleryMarkup = (images) => {\n  return images\n    .map(\n      (img) => `\n    <li class=\"li\">\n      <a href=\"${img.largeImageURL}\">\n        <img src=\"${img.webformatURL}\" alt=\"${img.tags}\" />\n      </a>\n      <div class=\"div\">\n        <p class=\"p\">Likes: ${img.likes}</p>\n        <p class=\"p\">Views: ${img.views}</p>\n        <p class=\"p\">Comments: ${img.comments}</p>\n        <p class=\"p\">Downloads: ${img.downloads}</p>\n      </div>\n    </li>\n  `\n    )\n    .join('');\n};\n\n/**\n * Очищує галерею та додає нові зображення.\n * @param {HTMLElement} galleryElement - елемент галереї.\n * @param {Array} images - список зображень для рендерингу.\n */\nexport const renderGallery = (galleryElement, images) => {\n  const markup = createGalleryMarkup(images);\n  galleryElement.innerHTML = markup;\n\n  if (!lightbox) {\n    lightbox = new SimpleLightbox('.gallery a');\n  } else {\n    lightbox.refresh();\n  }\n};\n","import 'izitoast/dist/css/iziToast.min.css';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport SimpleLightbox from 'simplelightbox';\nimport { fetchImages } from './js/pixabay-api.js';\nimport { renderGallery } from './js/render-functions.js';\n\nconst searchForm = document.getElementById('search-form');\nconst gallery = document.getElementById('gallery');\nconst loader = document.getElementById('loader');\nconst loadMoreBtn = document.getElementById('load-more');\n\nlet currentPage = 1;\nlet currentQuery = '';\n\nconst showLoader = () => loader.classList.remove('hidden');\nconst hideLoader = () => loader.classList.add('hidden');\nconst showLoadMoreBtn = () => loadMoreBtn.classList.remove('hidden');\nconst hideLoadMoreBtn = () => loadMoreBtn.classList.add('hidden');\n\nconst smoothScroll = () => {\n  const { height: cardHeight } = gallery.firstElementChild.getBoundingClientRect();\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n};\n\nconst handleSearch = async (event) => {\n  event.preventDefault();\n  currentQuery = searchForm.elements['search-input'].value.trim();\n\n  if (!currentQuery) {\n    iziToast.error({ title: 'Error', message: 'Please enter a search query!' });\n    return;\n  }\n\n  currentPage = 1;\n  gallery.innerHTML = '';\n  hideLoadMoreBtn();\n  showLoader();\n\n  try {\n    const { hits, totalHits } = await fetchImages(currentQuery, currentPage);\n    if (hits.length === 0) {\n      iziToast.warning({\n        title: 'No Results',\n        message: 'No images match your query. Try again!',\n      });\n    } else {\n      renderGallery(gallery, hits);\n      iziToast.success({\n        title: 'Success',\n        message: `Found ${totalHits} images!`,\n      });\n      if (hits.length < totalHits) showLoadMoreBtn();\n    }\n  } catch (error) {\n    iziToast.error({ title: 'Error', message: 'Something went wrong!' });\n  } finally {\n    hideLoader();\n  }\n};\n\nconst handleLoadMore = async () => {\n  currentPage += 1;\n  showLoader();\n  hideLoadMoreBtn();\n\n  try {\n    const { hits, totalHits } = await fetchImages(currentQuery, currentPage);\n    renderGallery(gallery, hits);\n    smoothScroll(); // Добавлено плавное скроллирование после рендеринга\n    if (currentPage * 15 >= totalHits) {\n      iziToast.info({\n        title: 'End of Results',\n        message: \"You've reached the end of search results.\",\n      });\n    } else {\n      showLoadMoreBtn();\n    }\n  } catch (error) {\n    iziToast.error({ title: 'Error', message: 'Failed to load more images!' });\n  } finally {\n    hideLoader();\n  }\n};\n\nsearchForm.addEventListener('submit', handleSearch);\nloadMoreBtn.addEventListener('click', handleLoadMore);\n"],"names":["API_KEY","BASE_URL","fetchImages","query","page","params","axios","lightbox","createGalleryMarkup","images","img","renderGallery","galleryElement","markup","SimpleLightbox","searchForm","gallery","loader","loadMoreBtn","currentPage","currentQuery","showLoader","hideLoader","showLoadMoreBtn","hideLoadMoreBtn","smoothScroll","cardHeight","handleSearch","event","iziToast","hits","totalHits","handleLoadMore"],"mappings":"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"}